{%extends 'post/base.html'%}
{%load crispy_forms_tags%}

{% load static %}

{% block header %}
<link rel="stylesheet" href="{% static 'users/css/login_register.css' %}">
<link rel="stylesheet" href="{% static 'users/css/profile.css' %}">
{% endblock header %}

{%load crispy_forms_tags%}
{%block content%}
<div class="profile-container">

  <div class="row row-cols-1">
    <div class="col col-md-4 col-lg-3">
    <!-- Profile Info Section -->
      <div class="card card-block border-0 shadow ">
        <div class="container mt-2">
          <img id="account_img" class="rounded-circle shadow account-img" src="{{ profile_image_url }}">
          <div class="mt-2">
            <h2 class="card-title mb-0">{{ user.first_name }} {{ user.last_name }}</h2>
            <p id="username">{{user.username}}</p>
            <a id="num-buddies" href="{% url 'list-friends' user.id %}">
              <p><i class="fas fa-user-friends"></i> <span class="fw-bold">{{friends|length}}</span> Buddies</p>
            </a>
            {% if friend_requests %}
          <a class="btn btn-primary" href="{% url 'list-friend-requests' user.id %}">
            <p>Friend Requests ({{friend_requests|length}})</p>
          </a>
          {% endif %}
          </div>
        </div>
      </div>
    </div>
    <div class="col col-md-8 col-lg-9">
      <div class="card shadow border-0 card-block-info">
        <div class="card-body card-info">
          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <fieldset class="form-group">
                <legend class="border-bottom mb-4">User Information</legend>
                {{ u_form|crispy }}
                {{ p_form|crispy }}
            </fieldset>
            <div class="form-group">
                <button class="mt-3 btn btn-primary" type="submit">Update</button>
            </div>
        </form>
        </div>
      </div>
    </div>
  </div>
</div>






<!-- <div class="container mt-5">
<div class="bg-light p-5 rounded m-3 profile-body">
  <h1 class="">My Account</h1>
  <div class="account-body">
          <h2 class="account-heading mt-3">{{ user.username }}</h2>
          <p class="text-secondary pb-2">{{ user.email }}</p>
          <a class="btn btn-primary" href="{% url 'list-friends' user.id %}">
            <p>Friends ({{friends|length}})</p>
          </a>
          {% if friend_requests %}
          <a class="btn btn-primary" href="{% url 'list-friend-requests' user.id %}">
            <p>Friend Requests ({{friend_requests|length}})</p>
          </a>
          {% endif %}
          <form method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <fieldset class="form-group">
                  <legend class="border-bottom mb-4">User Information</legend>
                <img id="account_img" class="rounded-circle shadow account-img" src="{{ profile_image_url }}">
                  {{ u_form|crispy }}
                  {{ p_form|crispy }}
              </fieldset>
              <div class="form-group">
                  <button class="mt-3 btn btn-primary" type="submit">Update</button>
              </div>
          </form>
  </div>
</div>
</div> -->

<script>

  function onFriendRequestAccepted() {location.reload()}
  function onFriendRequestDeclined() {location.reload()}

  function triggerAcceptFriendRequest(friend_request_id) {
      acceptFriendRequest(friend_request_id, onFriendRequestAccepted)
  }

  function triggerDeclineFriendRequest(friend_request_id) {
      declineFriendRequest(friend_request_id, onFriendRequestDeclined)
  }

</script>

{#% include 'users/snippets/decline_friend_request.html' %#}
{% include 'users/snippets/accept_friend_request.html' %}

{%endblock content%}

